"use strict";PULSE.app.templates["main-navigation.featured-link"]=_.template('<div class="navigation__featured-link-content"> <% if ( image ) { %> <img class="navigation__featured-link-image" src="<%= image %>"> <% } %> <div class="navigation__featured-link-caption"> <h3 class="navigation__featured-label"> <%= label %> <%= render( {\n                cssClass: \'label-icon\',\n                name: \'arrow-right\'\n            }, \'common.svg-icon\' ) %> </h3> <p class="navigation__featured-text"><%= description %></p> </div> </div> '),function(r,l,t,o){var n="is-fixed",a="is-hidden",i="is-active",s="menu-open",c="navigation-more-dropdown",d="search-open",u="sidebar-open",v="drop-down-open",e="u-body-fixed",g="ready",y=void 0;r.MainNavigationWidget=function(e){var n=this;n.container=e,n.body=document.querySelector(".js-body-content"),n.menuButton=n.container.querySelector(".js-navigation-menu-button"),n.mainMenu=n.container.querySelector(".js-navigation-menu"),n.mainMenuSecond=n.container.querySelector(".js-navigation-menu-second"),n.search=n.container.querySelector(".js-navigation-search"),n.searchOpen=n.container.querySelector(".js-navigation-search-open"),n.searchInput=n.container.querySelector(".js-navigation-search-input"),n.searchInputMobile=n.container.querySelector(".js-navigation-search-input-mobile"),n.searchButton=n.container.querySelector(".js-navigation-search-button"),n.sidebar=n.container.querySelector(".js-navigation-sidebar"),n.sidebarOpen=n.container.querySelector(".js-navigation-sidebar-open"),n.sidebarClose=[].slice.call(n.container.querySelectorAll(".js-navigation-sidebar-close")),n.sidebarMoreNav=n.container.querySelector(".js-navigation-sidebar-more-nav"),n.overlay=n.container.querySelector(".js-overlay"),n.boundToggleDropDown=n.toggleDropDown.bind(n),n.featuredLists=n.container.querySelectorAll(".js-featured-list"),n.scrollTop=document.body.scrollTop,n.moreMenuLinks=n.container.querySelectorAll(".js-more-menu"),n.secondaryMenuLinks=n.container.querySelector(".js-secondary-nav-items"),n.searchPlaceholder=n.container.querySelector(".js-search-placeholder"),n.telstraBar=document.querySelector('[data-widget="telstra-bar"]'),n.menuOrdered=!1,n.titleBar=n.container.querySelector(".js-navigation-title-bar"),n.titleBarHeight=n.titleBar.offsetHeight,n.navPos=n.container.getBoundingClientRect().bottom+n.scrollTop,n.offset=n.navPos-n.container.getBoundingClientRect().top-n.titleBarHeight-n.scrollTop,n.navPosOffset=n.navPos-n.offset,n.timeout,b.call(n),n.initialiseMoreNav(),n.orderMenu(),n.featuredLists.length&&n.initialiseFeaturedLink()},r.MainNavigationWidget.prototype.initialiseFeaturedLink=function(){var s=this;s.featuredLists.forEach(function(e){var n=e.querySelectorAll("[data-featured-link]");n&&n.length&&n.forEach(function(e){var n=e.dataset.featuredLink.split(","),t=n[0],a=n[1],i={label:e.dataset.label,tag:t,description:a},o={url:r.common.url.createContentPath("photo",{tagNames:["menu-item-thumb","menu-item-thumb:"+t]}),method:"GET",callback:s.handleMenuResponse.bind(s,i,e),target:s};l.data.manager.add(o)})})},r.MainNavigationWidget.prototype.handleMenuResponse=function(e,n,t){if(t.content&&0<t.content.length){l.style.addClass(n,"drop-down__option--featured"),e.image=r.common.image.getOnDemandImageUrl(t.content[0],88,88);var a=r.templating.render(e,"main-navigation.featured-link");n.firstElementChild.innerHTML=a}},r.MainNavigationWidget.prototype.initialiseMoreNav=function(){var e=this;e.moreNav=new t.moreNav({navWrap:e.mainMenu,activeClass:"is-active",openClass:"is-open",hideClass:"is-hidden",showClass:"u-show",minTrigger:9,moreDropdownClass:c,moreButton:""});var n=e.container.querySelector("."+c);n&&e.sidebarMoreNav.appendChild(n),e.setListeners(),l.style.addClass(e.mainMenu,g),l.style.addClass(e.mainMenuSecond,g)},r.MainNavigationWidget.prototype.setListeners=function(){var e=this,n=this;this.searchInputMobile&&(this.searchInputMobile.addEventListener("focus",function(){l.style.addClass(n.searchPlaceholder,o.U_HIDE)}),this.searchInputMobile.addEventListener("blur",function(){""===e.searchInputMobile.value&&l.style.removeClass(n.searchPlaceholder,o.U_HIDE)}),this.searchInputMobile.addEventListener("input",function(e){""===e.target.value?(l.style.removeClass(n.searchPlaceholder,o.U_HIDE),l.style.removeClass(n.searchButton,i)):(l.style.addClass(n.searchPlaceholder,o.U_HIDE),l.style.addClass(n.searchButton,i))})),this.menuButton.addEventListener("click",n.toggleMenu.bind(n)),this.sidebarOpen.addEventListener("click",n.toggleSidebar.bind(n)),this.sidebarClose.forEach(function(e){e.addEventListener("click",n.toggleSidebar.bind(n))}),this.searchOpen&&this.searchOpen.addEventListener("click",n.toggleSearch.bind(n)),this.overlay.addEventListener("click",m.bind(n)),this.setNavigationLinkListeners(),l.event.windowResize.add({method:n.setNavigationLinkListeners.bind(n)}),l.event.windowResize.add({method:n.orderMenu.bind(n)}),n.container.addEventListener("touchmove",function(){l.style.hasClass(n.container,s)&&_.debounce(document.body.scrollTop=0,100)}),this.stickyNav()},r.MainNavigationWidget.prototype.orderMenu=function(){var e=this;if(window.innerWidth<=r.measurements.tablet&&!e.menuOrdered){e.menuOrdered=!0;var n=e.container.querySelector(".js-nav-list"),t=e.moreMenuLinks[0],a=e.secondaryMenuLinks.cloneNode(!0);[].slice.call(a.children).forEach(function(e){n.insertBefore(e,t)}),l.style.addClass(e.secondaryMenuLinks,o.U_HIDE)}else if(window.innerWidth>r.measurements.tablet){e.menuOrdered=!1;var i=e.container.querySelector(".js-nav-list");[].slice.call(i.querySelectorAll(".js-secondary-item")).forEach(function(e){i.removeChild(e)}),l.style.removeClass(e.secondaryMenuLinks,o.U_HIDE)}},r.MainNavigationWidget.prototype.setNavigationLinkListeners=function(){var n=this;n.navigationLinks=[].slice.call(n.container.querySelectorAll(".js-navigation-link")),0<n.navigationLinks.length&&n.navigationLinks.forEach(function(e){e.removeEventListener("click",n.boundToggleDropDown),e.addEventListener("click",n.boundToggleDropDown)})},r.MainNavigationWidget.prototype.toggleMenu=function(){var e=this;e.overlay.style.marginTop=0,e.sidebar.style.marginTop=0,l.style.hasClass(e.container,s)?(l.style.removeClass(e.container,s),l.style.removeClass(e.telstraBar,"level-one"),f.call(e)):(l.style.addClass(e.container,s),l.style.addClass(e.telstraBar,"level-one"),p.call(e))},r.MainNavigationWidget.prototype.toggleDropDown=function(e){l.style.hasClass(e.currentTarget,v)?l.style.removeClass(e.currentTarget,v):(this.navigationLinks.forEach(function(e){l.style.removeClass(e,v)}),l.style.addClass(e.currentTarget,v))},r.MainNavigationWidget.prototype.toggleSidebar=function(){var e=this;if(!l.style.hasClass(e.container,d)){e.overlay.style.marginTop=0,e.sidebar.style.marginTop=0;var n=e.overlay.getBoundingClientRect().top,t=e.sidebar.getBoundingClientRect().top-e.mainMenu.offsetHeight;0<n&&(e.overlay.style.marginTop="-"+n),e.sidebar.style.marginTop="-"+t,l.style.hasClass(e.container,u)?(l.style.removeClass(e.container,u),l.style.removeClass(e.telstraBar,"level-one"),document.body.style.overflowY="auto"):(l.style.addClass(e.container,u),document.body.style.overflowY="hidden",l.style.addClass(e.telstraBar,"level-one"))}},r.MainNavigationWidget.prototype.toggleSearch=function(){l.style.hasClass(this.container,d)?m.call(this):h.call(this)},r.MainNavigationWidget.prototype.stickyNav=function(){var e=this;l.event.windowOnScroll.add({method:function(){e.scrollTop>document.body.scrollTop&&window.scrollY>e.navPos?(l.style.addClass(e.container,n),l.style.removeClass(e.container,a)):window.scrollY>e.navPosOffset&&window.scrollY<e.navPos?(l.style.addClass(e.container,n),l.style.removeClass(e.container,a)):window.scrollY>e.navPos&&!l.style.hasClass(e.container,s)&&(l.style.addClass(e.container,a),l.style.removeClass(e.container,n)),window.scrollY<=e.navPosOffset&&(l.style.removeClass(e.container,n),l.style.removeClass(e.container,a)),e.scrollTop=document.body.scrollTop,b.call(e)}})};var h=function(){var e=this;l.style.addClass(e.container,d),setTimeout(function(){e.overlay.style.marginTop=0,e.overlay.style.marginTop=-e.overlay.getBoundingClientRect().y+e.search.getBoundingClientRect().bottom},310)},m=function(){l.style.removeClass(this.container,d),l.event.listenForOutsideClick.removeElement(this.container)},p=function(){y=window.pageYOffset,this.body.scrollTop=y,l.style.addClass(this.body,e)},f=function(){l.style.removeClass(this.body,e),window.scrollTo(0,y)},b=function(){var e=this;clearTimeout(e.timeout),e.timeout=setTimeout(function(){!l.style.hasClass(e.container,n)&&window.scrollY>e.navPos&&(l.style.addClass(e.container,n),l.style.removeClass(e.container,a))},2e3)};r.widgetInitialiser.addWidget("main-navigation")}(PULSE.app,PULSE.core,PULSE.ui,PULSE.app.common.CONSTANTS);